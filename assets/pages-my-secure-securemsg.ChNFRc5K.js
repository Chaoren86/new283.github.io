import{l as e,N as s,m as t,X as o,u as l,a as n,w as a,j as i,o as c,b as d,f as r,e as u,v as p,g as w,x as h,i as f,I as m,C as _}from"./index-CzPo0QPm.js";import{_ as b}from"./uni-popup.CNbKZ3Om.js";import{r as g}from"./uni-app.es.CL_jKygs.js";import{$ as y}from"./request.BhjEuznL.js";import{_ as x}from"./fh.BHWO1jAk.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const v=k({data:()=>({phone:null,password:"",passwords:"",timer:null,count:"",UserInfo:{},code:""}),onLoad(){if(this.UserInfo=e("UserInfo"),!this.UserInfo.uid||!this.UserInfo.token)return s({url:"/pages/index/index"})},computed:{isPass(){return!(!this.password||!this.passwords)},isPhone(){return!!this.isMobile(this.phone)}},methods:{bindPhone(){this.$nextTick((()=>{this.$refs.bindphone_popup.open("center")}))},submitPhone(){if(!this.isMobile(this.phone))return t({title:"手机号码格式错误",duration:1e3,icon:"none"});y.post("/app_user_securemsg",{type:"bind",code:this.code,phone:this.phone}).then((e=>{if(console.log(e),200!=e.code)return t({title:e.msg,duration:1e3,icon:"none"});t({title:e.msg,duration:1e3,icon:"none"})}))},editorPassword(){if(!this.isMobile(this.UserInfo.phone))return t({title:"请先绑定手机号码",duration:1e3,icon:"none"});this.$nextTick((()=>{this.$refs.phone_popup.open("center")}))},submitPassword(){return 4!=this.code.length?t({title:"验证码错误",duration:1e3,icon:"none"}):""==this.password?t({title:"密码不能为空",duration:1e3,icon:"none"}):this.password!=this.passwords?t({title:"两次输入密码不一致",duration:1e3,icon:"none"}):void y.post("/app_user_securemsg",{type:"edit",code:this.code,password:this.password}).then((e=>(console.log(e),200==e.code?(t({title:e.msg,duration:1e3,icon:"none"}),o(),s({url:"/pages/index/index"})):t({title:e.msg,duration:1e3,icon:"none"}))))},getMessage(e){y.post("/app_user_get_message",{type:e,phone:this.phone}).then((e=>(console.log(e),200==e.code?(this.getPhoneCode(),t({title:e.msg,duration:1e3,icon:"none"})):t({title:e.msg,duration:1e3,icon:"none"}))))},getPhoneCode(){this.timer||(this.showCode=!0,this.count=60,this.timer=setInterval((()=>{this.count>0&&this.count<=60?this.count--:(this.showCode=!1,clearInterval(this.timer),this.timer=null)}),1e3))},isMobile:e=>/^1[3-9]\d{9}$/.test(e)}},[["render",function(e,s,t,o,y,k){const v=h,V=i,z=f,j=m,P=_,U=g(l("uni-popup"),b);return c(),n(V,{class:"content"},{default:a((()=>[d(V,{class:"w-750 w-bj-cont",style:{position:"fixed",top:"0",left:"0"}},{default:a((()=>[d(V,{class:"h-100 w-row-justify-between-align"},{default:a((()=>[d(V,{class:"wh-80 w-row-center",onClick:s[0]||(s[0]=s=>e.routerBack())},{default:a((()=>[d(v,{class:"wh-40",src:x})])),_:1}),d(V,{class:"w-250 h-100 w-row-center w-wz-conts font-36"},{default:a((()=>[r("安全管理")])),_:1}),d(V,{class:"wh-80"})])),_:1})])),_:1}),d(V,{class:"bwh-100"}),d(V,{class:"wh-30"}),d(V,{class:"w-710 w-row-end-justify-around-align"},{default:a((()=>[d(V,{class:"w-330 h-150 w-bj-cont w-bor-12 w-row-center",onClick:s[1]||(s[1]=e=>k.editorPassword())},{default:a((()=>[(c(),u("svg",{t:"1683438291388",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4141",width:"25",height:"25"},[p("path",{d:"M870.144 346.944h-55.68v-18.816c0-166.784-135.68-302.464-302.464-302.464s-302.464 135.68-302.464 302.464v18.816h-55.68c-42.24 0-76.8 34.56-76.8 76.8V947.2c0 42.24 34.56 76.8 76.8 76.8h716.288c42.24 0 76.8-34.56 76.8-76.8V423.744c0-42.24-34.56-76.8-76.8-76.8z m-278.592 287.36h-43.392v109.568c30.208 11.52 51.712 40.64 51.712 74.88 0 44.224-35.904 80.128-80.192 80.128s-80.192-35.904-80.192-80.128c0-34.24 21.504-63.36 51.712-74.88V503.36c0-15.68 12.8-28.48 28.48-28.48s28.48 12.8 28.48 28.48v73.984h43.392c15.68 0 28.48 12.8 28.48 28.48s-12.8 28.48-28.48 28.48z m158.912-287.36H273.536v-18.816c0-131.456 106.944-238.464 238.464-238.464s238.464 107.008 238.464 238.464v18.816z",fill:"#ccb581","p-id":"4142"})])),d(z,{class:"font-38b w-wz-conts m-left-6"},{default:a((()=>[r("修改密码")])),_:1})])),_:1}),d(V,{class:"w-330 h-150 w-bj-cont w-bor-12 w-row-center",onClick:s[2]||(s[2]=e=>k.bindPhone())},{default:a((()=>[(c(),u("svg",{t:"1683438596511",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"14363",width:"25",height:"25"},[p("path",{d:"M792.576 0q19.456 0 36.352 7.168t29.696 19.968 19.968 29.696 7.168 36.352l0 837.632q0 38.912-27.136 66.048t-66.048 27.136l-559.104 0q-38.912 0-66.048-27.136t-27.136-66.048l0-837.632q0-19.456 7.168-36.352t19.968-29.696 29.696-19.968 36.352-7.168l559.104 0zM419.84 93.184l185.344 0 0-47.104-185.344 0 0 47.104zM512 976.896q19.456 0 36.352-7.168t29.696-19.968 19.968-29.696 7.168-36.352-7.168-36.352-19.968-29.184-29.696-19.456-36.352-7.168q-38.912 0-65.536 26.624t-26.624 65.536 26.624 66.048 65.536 27.136zM792.576 139.264l-559.104 0 0 605.184 559.104 0 0-605.184z","p-id":"14364",fill:"#ccb581"})])),d(z,{class:"font-38b w-wz-conts m-left-6"},{default:a((()=>[r("绑定手机")])),_:1})])),_:1})])),_:1}),d(U,{style:{"z-index":"999"},ref:"phone_popup",type:"bottom"},{default:a((()=>[d(V,{class:"w-600 h-750 w-bj-white w-bor-25 w-col-center"},{default:a((()=>[d(V,{class:"h-80 font-36b"},{default:a((()=>[r("修改密码")])),_:1}),d(V,{class:"w-450 h-100"},{default:a((()=>[d(j,{type:"text",class:"phone_input",modelValue:y.UserInfo.nickname,"onUpdate:modelValue":s[3]||(s[3]=e=>y.UserInfo.nickname=e),disabled:""},null,8,["modelValue"])])),_:1}),d(V,{class:"w-450 h-100"},{default:a((()=>[d(j,{type:"text",class:"phone_input",modelValue:y.password,"onUpdate:modelValue":s[4]||(s[4]=e=>y.password=e),placeholder:"输入新密码"},null,8,["modelValue"])])),_:1}),d(V,{class:"w-450 h-100"},{default:a((()=>[d(j,{type:"text",class:"phone_input",modelValue:y.passwords,"onUpdate:modelValue":s[5]||(s[5]=e=>y.passwords=e),placeholder:"确认新密码"},null,8,["modelValue"])])),_:1}),d(V,{class:"w-450 h-100 w-relative"},{default:a((()=>[d(j,{type:"text",class:"phone_input",modelValue:y.code,"onUpdate:modelValue":s[6]||(s[6]=e=>y.code=e),placeholder:"验证码"},null,8,["modelValue"]),d(V,{class:"w-200 h-80 w-row-center",style:{position:"absolute",top:"2rpx",right:"2rpx"}},{default:a((()=>[y.count?(c(),n(V,{key:0,class:"font-28 w-wz-red m-left-10"},{default:a((()=>[r(" 重新获取"+w(y.count<10?"0"+y.count:y.count)+"秒 ",1)])),_:1})):(c(),n(V,{key:1},{default:a((()=>[k.isPass?(c(),n(V,{key:0,class:"font-28b w-wz-blue",onClick:s[7]||(s[7]=e=>k.getMessage("pass"))},{default:a((()=>[r("获取验证码")])),_:1})):(c(),n(V,{key:1,class:"font-28b w-wz-black9"},{default:a((()=>[r("获取验证码")])),_:1}))])),_:1}))])),_:1})])),_:1}),d(V,{class:"wh-30"}),d(V,{class:"w-450 h-80"},{default:a((()=>[d(P,{class:"w-bor-10 w-bj-gere w-wz-white w-row-center",onClick:s[8]||(s[8]=e=>k.submitPassword())},{default:a((()=>[d(V,{class:"w-row-align"},{default:a((()=>[d(z,{class:"font-32 m-left-6 m-top-6"},{default:a((()=>[r("确定修改密码")])),_:1})])),_:1})])),_:1})])),_:1}),d(V,{class:"wh-40"})])),_:1})])),_:1},512),d(U,{style:{"z-index":"999"},ref:"bindphone_popup",type:"bottom"},{default:a((()=>[d(V,{class:"w-600 h-500 w-bj-white w-bor-25 w-col-center"},{default:a((()=>[d(V,{class:"h-80 font-36b"},{default:a((()=>[r("绑定手机号")])),_:1}),d(V,{class:"w-450 h-100"},{default:a((()=>[d(j,{type:"number",class:"phone_input",modelValue:y.phone,"onUpdate:modelValue":s[9]||(s[9]=e=>y.phone=e),placeholder:"输入手机号"},null,8,["modelValue"])])),_:1}),d(V,{class:"w-450 h-100 w-relative"},{default:a((()=>[d(j,{type:"number",class:"phone_input",modelValue:y.code,"onUpdate:modelValue":s[10]||(s[10]=e=>y.code=e),placeholder:"验证码"},null,8,["modelValue"]),d(V,{class:"w-200 h-80 w-row-center",style:{position:"absolute",top:"2rpx",right:"2rpx"}},{default:a((()=>[y.count?(c(),n(V,{key:0,class:"font-28 w-wz-red m-left-10"},{default:a((()=>[r(" 重新获取"+w(y.count<10?"0"+y.count:y.count)+"秒 ",1)])),_:1})):(c(),n(V,{key:1},{default:a((()=>[k.isPhone?(c(),n(V,{key:0,class:"font-28b w-wz-blue",onClick:s[11]||(s[11]=e=>k.getMessage("bind"))},{default:a((()=>[r("获取验证码")])),_:1})):(c(),n(V,{key:1,class:"font-28b w-wz-black9"},{default:a((()=>[r("获取验证码")])),_:1}))])),_:1}))])),_:1})])),_:1}),d(V,{class:"wh-30"}),d(V,{class:"w-450 h-80"},{default:a((()=>[d(P,{class:"w-bor-10 w-bj-gere w-wz-white w-row-center",onClick:s[12]||(s[12]=e=>k.submitPhone())},{default:a((()=>[d(V,{class:"w-row-align"},{default:a((()=>[d(z,{class:"font-32 m-left-6 m-top-6"},{default:a((()=>[r("确定绑定")])),_:1})])),_:1})])),_:1})])),_:1}),d(V,{class:"wh-40"})])),_:1})])),_:1},512)])),_:1})}],["__scopeId","data-v-39a2c873"]]);export{v as default};
