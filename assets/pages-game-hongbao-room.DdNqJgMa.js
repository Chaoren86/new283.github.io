import{G as t,l as e,s as a,m as s,J as l,q as n,k as o,u as i,a as u,w as c,j as d,o as r,b as m,f as p,g as f,h as _,v as b,e as v,r as h,F as g,n as y,a3 as k,x,i as w,C as I,y as C,I as B,a4 as S,D as L,a5 as D}from"./index-CzPo0QPm.js";import{_ as N}from"./uni-popup.CNbKZ3Om.js";import{r as $}from"./uni-app.es.CL_jKygs.js";import{$ as R}from"./request.BhjEuznL.js";import{h as H,a as j,_ as E,b as F,c as q,d as A}from"./customer-icon.C9OAYTLS.js";import{_ as T}from"./goBack-icon.Dnnb51to.js";import{_ as P}from"./user.C18wHkI1.js";import{_ as U}from"./refresh-icon.DKxcLUp8.js";import{_ as V}from"./close-icon.CE_Px9pA.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";const G=z({data:()=>({typeText:["红包接龙","红包二八杠","红包扫雷","红包牛牛"],hongbaoicon:H,hongbaoiconN:j,configData:{},list:[],user_monye:0,time:null,lastItemId:null,postShow:!1,roomInfo:{},isSubmitting:!1,postData:{roomId:0,gameType:0,money:null},querFrom:{pagenum:1,pagesize:20,type:1},activeShow:!1,priceList:[10,50,100,500,1e3,5e3],price:null,numberList:[7,8,9],number:7,letNumberList:[0,1,2,3,4,5,6,7,8,9],leiNumber:0,submitLoading:!1,userInfo:{},HBdata:{}}),beforeCreate(){localStorage.getItem("isLoading")||t({title:"数据加载中",mask:!0})},onLoad(t){this.querFrom.type=this.postData.gameType=t.type,3==t.type&&(this.activeShow=!0),this.initAudio(),this.configData=e("Config"),this.postData.roomId=t.roomId,this.querFrom.roomId=t.roomId,this.getRoom(),this.getList(),this.getUserInfo()},methods:{initAudio(){const t=new(window.AudioContext||window.webkitAudioContext),e=new Audio("/static/mp3/comeIn.mp3");t.createMediaElementSource(e).connect(t.destination),e.play()},ophbAudio(){const t=new(window.AudioContext||window.webkitAudioContext),e=new Audio("/static/mp3/open.mp3");t.createMediaElementSource(e).connect(t.destination),e.play()},handleEnter(){this.postRedEnvelopes()},getUserInfo(){R.post("/app_user_get_userinfo").then((t=>{200==t.code&&(this.userInfo=t.data,a("UserInfo",t.data))}))},selectLei(t){this.leiNumber=t},selectNumber(t){this.number=t},postRedEnvelopes(){if(!this.isSubmitting){if(!this.postData.money)return s({title:"请输入下注金额",duration:1e3,icon:"none"});this.isSubmitting=!0,3==this.postData.gameType&&(this.postData.number=this.number,this.postData.leiNumber=this.leiNumber),R.post("/app_red_envelope_betpour",this.postData).then((t=>200==t.code?(this.closeSubBet(),this.closeBet(),this.getList(),s({title:"下注成功",duration:1e3,icon:"none"})):s({title:t.msg,duration:1e3,icon:"none"}))).finally((()=>{this.isSubmitting=!1}))}},getRoom(){R.post("/app_red_envelope_room_odds",{type:this.postData.gameType,roomId:this.postData.roomId}).then((t=>{console.log(t,"getRoom"),200==t.code&&(this.roomInfo=t.data)}))},getList(){R.post("/app_red_envelope_list",this.querFrom).then((t=>{200==t.code&&(this.list=t.data.data,this.user_monye=t.data.user_monye,setTimeout((()=>{this.lastItemId="item"+(this.list.length-1)}),10),localStorage.setItem("isLoading",!0),l())}))},toIm(){n({url:"/pages/im/im"})},openPostBox(){this.$refs.post.open()},closePost(){this.$refs.post.close()},openRule(){this.$refs.popup.open()},closeRoom(){this.$refs.popup.close()},openBetting(){3==this.roomInfo.type?this.$refs.betting.open():this.$refs.subbetting.open()},closeBet(){this.$refs.betting.close()},openSubBet(){this.$refs.subbetting.open()},closeSubBet(){this.postData.money=null,this.$refs.subbetting.close()},countPrice(t){this.postData.money=Number(this.postData.money)+Number(t)},closeHB(){this.$refs.hbEnvCoverPopup.close()},openHB(t){if(this.submitLoading)return;this.submitLoading=!0;let e=this;R.post("/app_red_envelope_rob",{id:t.id}).then((a=>{if(this.submitLoading=!1,200!=a.code)return s({title:a.msg,duration:1e3,icon:"none"});e.ophbAudio(),o({url:"/pages/game/hongbao/detail?id="+t.id}),this.$refs.hbEnvCoverPopup.close()}))},openHBCover(t){t.selectShow?o({url:"/pages/game/hongbao/detail?id="+t.id}):(this.HBdata=t,this.$refs.hbEnvCoverPopup.open())},updateList(){this.list=[],this.getList(),this.$nextTick((()=>{this.lastItemId="item"+(this.list.length-1)}))},updateLastItemId(t){},toIndex(){n({url:"/pages/index/index"})},toRecord(){o({url:`/pages/my/record/list?index=2&game_type=${this.querFrom.type}`})}},onShow(){this.time=setInterval((()=>{this.getList()}),3e3)},onUnload(){this.time&&(clearInterval(this.time),this.time=null),localStorage.removeItem("isLoading")},onHide(){this.time&&(clearInterval(this.time),this.time=null),localStorage.removeItem("isLoading")}},[["render",function(t,e,a,s,l,n){const o=x,R=d,H=w,j=I,z=C,G=B,J=S,M=$(i("uni-popup"),N),W=L,K=D;return r(),u(R,{class:"room"},{default:c((()=>[m(R,{class:"w-750 w-bj-white",style:{position:"fixed",top:"0",left:"0","z-index":"999"}},{default:c((()=>[m(R,{class:"h-100 w-row-justify-between-align"},{default:c((()=>[m(R,{class:"wh-80 w-row-center",onClick:e[0]||(e[0]=e=>t.routerBack())},{default:c((()=>[m(o,{class:"wh-40",src:T})])),_:1}),m(R,{class:"flex1 h-100 w-row-center w-wz-conts font-36"},{default:c((()=>[m(H,null,{default:c((()=>[p(f(l.typeText[l.roomInfo.type-1]),1)])),_:1})])),_:1}),m(R,{class:"wh-80 w-row-center"})])),_:1})])),_:1}),m(R,{class:"bwh-120"}),m(R,{class:"content-box padding-top-xs"},{default:c((()=>[m(R,{class:"cover-tw index-bg absolute-default absolute top-bg disflex"},{default:c((()=>[m(R,{class:"padding-sm padding-top-xs padding-bottom-0 chat-user text-color-white number-font flex1"},{default:c((()=>[m(R,{class:"van-row van-row--align-center disflex"},{default:c((()=>[m(R,{class:"van-col van-col--12 rel disflex"},{default:c((()=>[l.userInfo.headimgurl?(r(),u(o,{key:0,src:l.userInfo.headimgurl,mode:"widthFix",class:"radius-sm avatar fl margin-right-xs"},null,8,["src"])):(r(),u(o,{key:1,src:P,mode:"widthFix",class:"radius-sm avatar fl margin-right-xs"})),m(R,null,{default:c((()=>[m(R,{class:"disflex"},{default:c((()=>[1==l.configData.vip_open?(r(),u(o,{key:0,class:"vip_icon",src:"/static/gane/vip_icon_"+(l.userInfo.vip?l.userInfo.vip:0)+".png",mode:"heightFix"},null,8,["src"])):_("",!0),p(" "+f(l.userInfo.nickname||"游客"),1)])),_:1}),b("span",{class:"line-height-none text-bold",style:{transform:"translateY(4rpx)"}}," 余额："+f(l.user_monye),1)])),_:1})])),_:1}),m(R,{class:"van-col van-col--12"},{default:c((()=>[m(R,{class:"fr wallet"},{default:c((()=>[m(j,{class:"van-button van-button--default van-button--small margin-left-xs",onClick:n.toIndex},{default:c((()=>[p(" 首页 ")])),_:1},8,["onClick"]),m(j,{class:"van-button van-button--default van-button--small margin-left-xs",onClick:e[1]||(e[1]=e=>t.routerWallet())},{default:c((()=>[p(" 上分 ")])),_:1}),m(j,{class:"van-button van-button--default van-button--small margin-left-xs",onClick:e[2]||(e[2]=e=>t.routerWallet())},{default:c((()=>[p(" 下分 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(z,{"scroll-y":"true",class:"chat-box padding-left-sm padding-right-sm padding-top-xs envelope","scroll-into-view":l.lastItemId},{default:c((()=>[l.list.length>0?(r(!0),v(g,{key:0},h(l.list,((t,e)=>(r(),u(R,{class:"fl full-width",key:e,id:`item${e}`},{default:c((()=>[m(R,{class:y(["cell packet",{"cell-r":t.userId===l.userInfo.uid}])},{default:c((()=>[m(R,{class:"full-width fl rel"},{default:c((()=>[m(R,{class:"avatar avatar-r"},{default:c((()=>[m(R,{class:"van-image"},{default:c((()=>[t.headimgurl&&t.userId==l.userInfo.uid?(r(),u(o,{key:0,src:t.headimgurl,class:"van-image__img"},null,8,["src"])):t.headimgurl?(r(),u(o,{key:1,src:t.headimgurl,class:"van-image__img"},null,8,["src"])):(r(),u(o,{key:2,src:P,class:"van-image__img"}))])),_:2},1024)])),_:2},1024),m(R,{class:"name name-r"},{default:c((()=>[1==l.configData.vip_open?(r(),u(o,{key:0,class:"vip_icon",src:"/static/gane/vip_icon_"+(t.vip?t.vip:1)+".png",mode:"heightFix"},null,8,["src"])):_("",!0),p(" "+f(t.nickname),1)])),_:2},1024),m(R,{class:y(["chat-item chat-item-r",{open:t.endNumber>=t.number||t.selectShow}]),onClick:e=>n.openHBCover(t)},{default:c((()=>[m(o,{class:"hongbao",src:t.endNumber>=t.number||t.selectShow?l.hongbaoiconN:l.hongbaoicon,mode:"widthFix"},null,8,["src"]),m(R,{class:"info line-height-sm"},{default:c((()=>[m(R,{class:"full-width fl"},{default:c((()=>[b("span",null," 金额 "+f(t.money),1),b("span",{class:"text-sm"},f(t.endNumber)+"/"+f(t.number),1)])),_:2},1024),m(R,{class:"full-width fl"},{default:c((()=>[b("span",{class:"text-sm"},f(t.endNumber>=t.number?"已被领完":t.selectShow?"已领取":"可领取"),1),3==t.type?(r(),v("span",{key:0},"雷"+f(t.leiNumber),1)):_("",!0)])),_:2},1024)])),_:2},1024),m(R,{class:"bar"},{default:c((()=>[b("b",null,"微信红包")])),_:1})])),_:2},1032,["class","onClick"])])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["id"])))),128)):(r(),u(R,{key:1,class:"fl full-width"},{default:c((()=>[m(R,{class:"cell packet"},{default:c((()=>[m(R,{class:"full-width fl rel"},{default:c((()=>[m(R,{class:"avatar avatar-r"},{default:c((()=>[m(R,{class:"van-image"},{default:c((()=>[m(o,{src:E,class:"van-image__img"})])),_:1})])),_:1}),m(R,{class:"name name-r"},{default:c((()=>[p(" 管理员 "),b("div",{style:{margin:"0 15rpx"}})])),_:1}),m(R,{class:"chat-item chat-item-r"},{default:c((()=>[p(" 尊敬的贵宾您好，当前为平台封盘时间"),b("span",{style:{color:"red"}},"23:50~00:10"),p("，给你造成的不便，敬请谅解！ ")])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1},8,["scroll-into-view"])])),_:1}),m(R,{class:"chat-menu full-width text-center"},{default:c((()=>[m(R,{class:"van-row van-row--align-center"},{default:c((()=>[m(R,{class:"van-col van-col--6",onClick:n.toRecord},{default:c((()=>[m(j,{class:"van-button van-button--default van-button--small van-button--round"},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(o,{class:"icon",src:F,mode:""}),p(" 记录 ")])),_:1})])),_:1})])),_:1},8,["onClick"]),m(R,{class:"van-col van-col--6",onClick:n.openRule},{default:c((()=>[m(j,{class:"van-button van-button--default van-button--small van-button--round"},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(o,{class:"icon",src:q,mode:""}),p(" 规则 ")])),_:1})])),_:1})])),_:1},8,["onClick"]),m(R,{class:"van-col van-col--6",onClick:e[3]||(e[3]=t=>n.toIm())},{default:c((()=>[m(j,{class:"van-button van-button--default van-button--small van-button--round"},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(o,{class:"icon",src:A,mode:""}),p(" 客服 ")])),_:1})])),_:1})])),_:1}),m(R,{class:"van-col van-col--6",onClick:n.updateList},{default:c((()=>[m(j,{class:"van-button van-button--default van-button--small van-button--round"},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(o,{class:"icon",src:U,mode:""}),p(" 刷新 ")])),_:1})])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),m(R,{class:"chat-tools"},{default:c((()=>[m(R,{class:"bar"},{default:c((()=>[m(R,{class:"quick text-center",onClick:n.openBetting},{default:c((()=>[p(" 快捷"),b("br"),p(" 发包 ")])),_:1},8,["onClick"])])),_:1}),m(R,{class:"funbar"},{default:c((()=>[m(G,{type:"text",class:"input",placeholder:"可输入玩法点数",modelValue:l.postData.money,"onUpdate:modelValue":e[4]||(e[4]=t=>l.postData.money=t)},null,8,["modelValue"])])),_:1}),m(R,{class:"send text-center text-color-white",onClick:n.postRedEnvelopes},{default:c((()=>[p(" 发送 ")])),_:1},8,["onClick"])])),_:1}),m(M,{ref:"popup",type:"bottom","border-radius":"10px 10px 0 0"},{default:c((()=>[m(R,{class:"gameDetailBox"},{default:c((()=>[m(R,{class:"padding-sm"},{default:c((()=>[m(R,{class:"padding-bottom-sm title font-24b"},{default:c((()=>[p(" 【"+f(l.typeText[l.roomInfo.type-1])+"介绍】 ",1),m(J,{nodes:l.roomInfo.desc},null,8,["nodes"]),m(o,{class:"close-icon",src:V,onClick:n.closeRoom},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},512),m(M,{ref:"betting",type:"bottom","border-radius":"10px 10px 0 0"},{default:c((()=>[m(R,{class:"betting"},{default:c((()=>[m(R,{class:"padding-sm"},{default:c((()=>[m(R,{class:"padding-bottom-sm title"},{default:c((()=>[p(" 快捷下注 "),m(o,{class:"close-icon",src:V,onClick:n.closeBet},null,8,["onClick"])])),_:1})])),_:1}),m(R,null,{default:c((()=>[3!=l.roomInfo.type?(r(),u(R,{key:0,class:"padding-bottom-sm title sel"},{default:c((()=>[p(" 选玩法 ")])),_:1})):(r(),u(R,{key:1,class:"padding-bottom-sm title sel"},{default:c((()=>[p(" 选雷 ")])),_:1}))])),_:1}),m(R,{class:"van-tab__panel"},{default:c((()=>[m(R,{class:"van-row padding-top-sm"},{default:c((()=>[3!=l.roomInfo.type?(r(),u(R,{key:0,class:"van-col van-col--24 padding-xxs padding-top-0"},{default:c((()=>[m(j,{onClick:e[5]||(e[5]=t=>l.activeShow=!0),class:y([{active:l.activeShow},"van-button van-button--primary van-button--normal van-button--plain van-button--block van-button--hairline van-hairline--surround quickItem"])},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(R,{class:"van-button__text"},{default:c((()=>[b("span",{class:"name"},f(l.typeText[l.roomInfo.type-1]),1)])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})):(r(),u(R,{key:1,class:"van-col van-col--24 padding-xxs padding-top-0"},{default:c((()=>[m(R,{class:"lei-title"},{default:c((()=>[p("抢包人数")])),_:1}),m(R,{class:"lei-number-box"},{default:c((()=>[(r(!0),v(g,null,h(l.numberList,((t,e)=>(r(),u(j,{onClick:e=>n.selectNumber(t),class:y([l.number==t?"active":"","van-button van-button--primary van-button--normal van-button--plain van-button--block van-button--hairline van-hairline--surround quickItem"]),key:e},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(R,{class:"van-button__text"},{default:c((()=>[b("span",{class:"name"},f(t),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1}),m(R,{class:"lei-title"},{default:c((()=>[p("选雷")])),_:1}),m(R,{class:"van-row"},{default:c((()=>[(r(!0),v(g,null,h(l.letNumberList,((t,e)=>(r(),u(j,{onClick:e=>n.selectLei(t),class:y([l.leiNumber==t?"active":"","van-col--5 van-button van-button--primary van-button--normal van-button--plain van-button--block van-button--hairline van-hairline--surround quickItem"]),key:e},{default:c((()=>[m(R,{class:"van-button__content"},{default:c((()=>[m(R,{class:"van-button__text"},{default:c((()=>[b("span",{class:"name"},"雷"+f(t),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}))])),_:1})])),_:1}),m(R,{class:"submit-bar"},{default:c((()=>[m(R,{class:"van-submit-bar van-safe-area-bottom"},{default:c((()=>[m(R,{class:"van-submit-bar__bar"},{default:c((()=>[m(R,{class:"van-submit-bar__text",style:{"text-align":"left"}},{default:c((()=>[p(" 共 "),b("span",{class:"van-submit-bar__price-integer"},f(l.activeShow?1:0),1),p(" 注 ")])),_:1}),m(j,{onClick:n.openSubBet,disabled:!l.activeShow,class:"van-button van-button--danger van-button--normal van-button--round van-submit-bar__button van-submit-bar__button--danger"},{default:c((()=>[p(" 下一步 ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},512),m(M,{ref:"subbetting",type:"bottom","border-radius":"10px 10px 0 0"},{default:c((()=>[m(R,{class:"betting"},{default:c((()=>[m(R,{class:"padding-sm"},{default:c((()=>[m(R,{class:"padding-bottom-sm title"},{default:c((()=>[p(" 确认发包金额 "),m(o,{class:"close-icon",src:V,onClick:n.closeSubBet},null,8,["onClick"])])),_:1})])),_:1}),m(R,{class:"van-cell van-field disflex"},{default:c((()=>[m(R,{class:"van-cell__title van-field__label"},{default:c((()=>[m(W,{for:"van-field-4-input"},{default:c((()=>[p("下注金额")])),_:1})])),_:1}),m(R,{class:"van-cell__value van-field__value"},{default:c((()=>[m(R,{class:"van-field__body"},{default:c((()=>[m(G,{id:"van-field-27-input",type:"number",min:"1",step:"1",modelValue:l.postData.money,"onUpdate:modelValue":e[6]||(e[6]=t=>l.postData.money=t),class:"van-field__control",placeholder:"请输入下注金额",onConfirm:n.handleEnter},null,8,["modelValue","onConfirm"])])),_:1})])),_:1}),m(R,{class:"van-col van-col--3 margin-bottom-xs title-align",onClick:e[7]||(e[7]=t=>l.postData.money=null)},{default:c((()=>[m(R,{class:"keybordBtn"},{default:c((()=>[p(" 清空 ")])),_:1})])),_:1})])),_:1}),m(R,{class:"margin-top-sm title-align"},{default:c((()=>[p(" 快速选择 ")])),_:1}),m(R,{class:"van-row margin-top-sm"},{default:c((()=>[(r(!0),v(g,null,h(l.priceList,((t,e)=>(r(),u(R,{class:"van-col van-col--3 margin-bottom-xs title-align",key:e,onClick:e=>n.countPrice(t)},{default:c((()=>[m(R,{class:"keybordBtn"},{default:c((()=>[p(f(t),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),m(R,{class:"van-col van-col--3 margin-bottom-xs title-align",onClick:e[8]||(e[8]=t=>l.postData.money=null)},{default:c((()=>[m(R,{class:"keybordBtn"},{default:c((()=>[p(" 清空 ")])),_:1})])),_:1})])),_:1}),m(R,{class:"submit-bar"},{default:c((()=>[m(R,{class:"van-submit-bar van-safe-area-bottom"},{default:c((()=>[m(R,{class:"van-submit-bar__bar"},{default:c((()=>[m(j,{onClick:e[9]||(e[9]=t=>n.postRedEnvelopes()),style:{margin:"0 auto"},class:"van-button van-button--danger van-button--normal van-button--round van-submit-bar__button van-submit-bar__button--danger"},{default:c((()=>[p(" 确认发包 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},512),m(M,{ref:"hbEnvCoverPopup",type:"center","mask-click":!1},{default:c((()=>[b("div",{class:"hbEnvCoverBox",onClick:e[11]||(e[11]=t=>n.openHB(l.HBdata))},[m(o,{onClick:e[10]||(e[10]=k((t=>n.closeHB()),["stop"])),class:"gb-icon",src:"/assets/gb-C1_AswTR.png",mode:"widthFix"}),m(R,{class:"title"},{default:c((()=>[b("span",{class:"name"},[l.HBdata.headimgurl?(r(),u(o,{key:0,src:l.HBdata.headimgurl,class:"van-image__img"},null,8,["src"])):(r(),u(o,{key:1,src:P,class:"van-image__img"})),p(" "+f(l.HBdata.nickname)+"的红包 ",1)])])),_:1})])])),_:1},512),m(K,{"canvas-id":"audioComeIn",style:{display:"none"}})])),_:1})}],["__scopeId","data-v-1ead54f2"]]);export{G as default};
