import{l as e,W as t,m as a,k as o,ab as n,J as s}from"./index-BrfRr25j.js";const r={baseUrl:"/api",baseImgUrl:"/api"},d={common:{baseUrl:r.baseUrl,header:{"Content-Type":"application/json;charset=UTF-8"},data:{},method:"GET",dataType:"json",token:!0},request(n={}){n.url=this.common.baseUrl+n.url,n.header=n.header||this.common.header,n.data=n.data||this.common.data,n.method=n.method||this.common.method,n.dataType=n.dataType||this.common.dataType,n.token=!1!==n.token&&this.common.token;const s=e("UserInfo");return n.header.uid=s.uid||"",n.header.token=s.token||"",new Promise(((e,s)=>{t({...n,success:t=>{if(n.native)return e(t);if(200!==t.statusCode){let e=t.data.data;return e="Token 令牌不合法!"==e?"登录已失效，请重新登录":e,!1!==n.toast&&a({title:e||"请求失败!",icon:"none"}),s(t.data)}let r=t.data;if(401===r.code)return o({url:"/pages/login/login"}),s(t.data);e(r)},fail:e=>(a({title:e.errMsg||"请求失败",icon:"none"}),s(e))})}))},get(e,t={},a={}){return a.url=e,a.data=t,a.method="GET",this.request(a)},post(e,t={},a={}){return a.url=e,a.data=t,a.method="POST",this.request(a)},del(e,t={},a={}){return a.url=e,a.data=t,a.method="DELETE",this.request(a)},upload(e,t,o=!1){return new Promise(((r,d)=>{let i=n("token");i||a({title:"请先登录",icon:"none"});s({url:this.common.baseUrl+e,filePath:t.filePath,name:t.name||"files",header:{token:i},success:e=>{if(200!==e.statusCode)return a({title:"上传失败",icon:"none"});let t=JSON.parse(e.data);r(t.data)},fail:e=>{console.log(e),d(e)}}).onProgressUpdate((e=>{"function"==typeof o&&o(e.progress)}))}))}};export{d as $,r as a};
